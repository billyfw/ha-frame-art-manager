# Activity Analytics Tab Design

## Status: MVP Implemented âœ…

### Completed Features
- âœ… Backend route (`/api/analytics/summary`) reads `summary.json` and `events.json`
- âœ… Analytics sub-tab added to Advanced Settings
- âœ… Simplified summary header (image count + TV list with hours/images per TV)
- âœ… Overall pie chart showing time by image (top 7 + other)
- âœ… TV cards with pie charts showing tag breakdown
- âœ… Tag selector with detail view (TV breakdown, top images)
- âœ… Image dropdown selector with detail view (TV breakdown, thumbnail, tags)
- âœ… Timeline bar showing display periods for selected image+TV (reads from `events.json`)
- âœ… Empty/error states
- âœ… No emojis in UI
- âœ… CSS conic-gradient pie charts (no external library)
- âœ… Load-once data (refresh by reloading page)

### Not Yet Implemented
- â³ **Time range selector** (last hour, day, week, month, 6 months, all time)
- â³ Time range filtering across all columns
- â³ localStorage persistence for time range selection
- â³ Export data feature
- â³ Integration with gallery (navigate to image)

---

## Overview
A new "Analytics" sub-tab within Advanced Settings that displays activity logging data from the Frame Art Shuffler integration. This tab reads the `summary.json` and `events.json` files generated by the integration.

## Data Source
- **Summary:** `/config/frame_art/logs/summary.json` (aggregated stats)
- **Events:** `/config/frame_art/logs/events.json` (individual display sessions for timeline)
- **Refresh:** Load once on tab open; refresh by reloading page
- **Fallback:** Show "No activity data yet" if files don't exist or logging is disabled

## Current Layout

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Advanced Settings                                                        [X]  â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                         â”‚
â”‚ â”‚  Settings   â”‚  Metadata  â”‚ Sync Detail â”‚ Analytics â”‚                         â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                         â”‚
â”‚                                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€ Summary â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Overall Pie Chart â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚ 14 images                 â”‚  â”‚  [Pie chart: time by image]           â”‚      â”‚
â”‚  â”‚ Living Room: 333.3h / 10  â”‚  â”‚  + vertical legend (top 7 + other)    â”‚      â”‚
â”‚  â”‚ Bedroom: 125.0h / 5       â”‚  â”‚                                       â”‚      â”‚
â”‚  â”‚ Office: 54.2h / 5         â”‚  â”‚                                       â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚                                                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚    TVs              â”‚     Tags            â”‚    Images           â”‚           â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤           â”‚
â”‚  â”‚  [TV Cards with     â”‚  [Tag dropdown +    â”‚  [Image dropdown +  â”‚           â”‚
â”‚  â”‚   pie charts]       â”‚   TV breakdown +    â”‚   thumbnail +       â”‚           â”‚
â”‚  â”‚                     â”‚   top images]       â”‚   TV breakdown +    â”‚           â”‚
â”‚  â”‚                     â”‚                     â”‚   timeline bar]     â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Column 1: TVs Overview

### Purpose
Show at-a-glance statistics for each configured TV with visual breakdown of display time by matched tags.

### Components

#### A. Time Range Selector (Sticky at top)
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Show:  [24h] [7d] [30d] [All Time]  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```
- Filters data displayed across all columns
- Persists selection in localStorage

#### B. TV Cards (Scrollable list)
For each TV:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ“º Living Room Frame                â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
â”‚        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
â”‚        â”‚  ğŸ¥§ Pie   â”‚  123.5 hours   â”‚
â”‚        â”‚  Chart    â”‚  456 sessions  â”‚
â”‚        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
â”‚                                     â”‚
â”‚  Legend:                            â”‚
â”‚  â— nature (42%)  â— family (28%)     â”‚
â”‚  â— landscape (18%) â— <none> (12%)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Pie Chart Details:**
- Uses `matched_tags` from per-TV data (tags that match TV's include_tags filter)
- Shows top 5 tags + "other" if more exist
- Special `<none>` tag for untagged images
- Click on pie segment â†’ filters Tags column to that tag

**Card Info:**
- TV name (from summary)
- Total display hours
- Session count
- Share of total tracked time (as subtle percentage)

#### C. TV Comparison Bar (Optional)
Horizontal stacked bar at bottom showing relative display time across all TVs:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘ Living Room 65% â”‚
â”‚ â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ Bedroom 35%     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Column 2: Tags Analysis

### Purpose
Deep-dive into a specific tag's performance across all TVs.

### Components

#### A. Tag Selector
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Select Tag: [â–¼ nature             ] â”‚
â”‚             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚             â”‚ nature (45.2h)       â”‚â”‚
â”‚             â”‚ family (32.1h)       â”‚â”‚
â”‚             â”‚ landscape (28.5h)    â”‚â”‚
â”‚             â”‚ portrait (15.3h)     â”‚â”‚
â”‚             â”‚ <none> (12.0h)       â”‚â”‚
â”‚             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```
- Dropdown sorted by total display time (descending)
- Shows hours next to each tag name
- Pre-selects most-displayed tag or tag clicked from TV pie chart

#### B. Tag Summary Card
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ·ï¸ nature                           â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
â”‚ Total Display: 45.2 hours           â”‚
â”‚ Sessions: 234                       â”‚
â”‚ Images with tag: 47                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### C. TV Breakdown (Horizontal Bar Chart)
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Display by TV:                      â”‚
â”‚                                     â”‚
â”‚ Living Room  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘ 65%    â”‚
â”‚              28.5h (152 sessions)   â”‚
â”‚                                     â”‚
â”‚ Bedroom      â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ 35%    â”‚
â”‚              16.7h (82 sessions)    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### D. Top Images for Tag (Scrollable List)
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Top Images:                         â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
â”‚ 1. sunset-beach.jpg      12.3h  ğŸ“· â”‚
â”‚ 2. forest-morning.jpg     8.5h  ğŸ“· â”‚
â”‚ 3. mountain-view.jpg      6.2h  ğŸ“· â”‚
â”‚ 4. lake-reflection.jpg    5.1h  ğŸ“· â”‚
â”‚ 5. autumn-leaves.jpg      4.8h  ğŸ“· â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```
- Click image name â†’ selects it in Column 3
- ğŸ“· icon â†’ opens image in thumbnail viewer/modal (if available)
- Shows top 10 by default, "Show more" expands

---

## Column 3: Image Detail

### Purpose
See complete display history for a specific image across all TVs.

### Components

#### A. Image Selector
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Search: [sunset                   ] â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚         â”‚ sunset-beach.jpg   12.3h â”‚â”‚
â”‚         â”‚ sunset-hills.jpg    3.2h â”‚â”‚
â”‚         â”‚ sunset-ocean.jpg    1.5h â”‚â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```
- Type-ahead search filtering
- Shows hours next to filename
- Pre-selects image clicked from Tags column

#### B. Image Preview Card
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚                                 â”‚ â”‚
â”‚ â”‚       [Thumbnail Image]        â”‚ â”‚
â”‚ â”‚                                 â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ sunset-beach.jpg                    â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
â”‚ Total Display: 12.3 hours           â”‚
â”‚ Sessions: 48                        â”‚
â”‚ Tags: nature, landscape, sunset     â”‚
â”‚                                     â”‚
â”‚ [View in Gallery]                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```
- Thumbnail from `/thumbs/` directory
- "View in Gallery" opens the main gallery filtered/scrolled to this image

#### C. TV History (Per-TV breakdown)
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Display History by TV:              â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
â”‚                                     â”‚
â”‚ ğŸ“º Living Room Frame                â”‚
â”‚    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘ 75%       â”‚
â”‚    9.2h across 36 sessions          â”‚
â”‚                                     â”‚
â”‚ ğŸ“º Bedroom Frame                    â”‚
â”‚    â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘ 25%       â”‚
â”‚    3.1h across 12 sessions          â”‚
â”‚                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### D. Recent Sessions (Optional - Expandable)
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Recent Sessions: [â–¼ Show]           â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
â”‚ Dec 3, 10:15am  Living Room  15min  â”‚
â”‚ Dec 2, 8:30pm   Bedroom      2.5hr  â”‚
â”‚ Dec 2, 2:00pm   Living Room  45min  â”‚
â”‚ Dec 1, 9:00am   Living Room  3hr    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```
- Shows last 10 session entries from events.json (if accessible)
- Could be omitted in v1 for simplicity

---

## Header Section

### Overview Stats
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ“Š Activity Overview                                                            â”‚
â”‚                                                                                 â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚ â”‚   512.5      â”‚ â”‚     456      â”‚ â”‚      3       â”‚ â”‚     47       â”‚            â”‚
â”‚ â”‚   hours      â”‚ â”‚   sessions   â”‚ â”‚     TVs      â”‚ â”‚    images    â”‚            â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚                                                                                 â”‚
â”‚ Last updated: Dec 3, 2025 10:15 AM   Retention: 6 months                       â”‚
â”‚                                                                                 â”‚
â”‚ [ğŸ”„ Refresh]  [âš™ï¸ Configure Logging]                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Actions
- **Refresh:** Re-fetch summary.json
- **Configure Logging:** Opens Home Assistant integration options (link or button that calls HA service)
- **Clear Logs:** Confirmation dialog â†’ calls `frame_art_shuffler.clear_display_log` service

---

## Responsive Behavior

### Desktop (>1200px)
- Full three-column layout as shown above

### Tablet (768px - 1200px)
- Two columns: TVs | Tags+Images
- Tags and Images stack vertically in second column
- Or: Tabbed interface for the three sections

### Mobile (<768px)
- Single column with tabs/accordion
- Swipe between TVs, Tags, Images sections
- Simplified pie charts (legend only, no visual chart)

---

## Technical Implementation

### New Files
1. **`routes/analytics.js`** - Backend route to read logs
2. **CSS additions to `style.css`** - Analytics-specific styles
3. **JS additions to `app.js`** - Analytics tab functionality

### Backend Route: `/api/analytics/summary`
```javascript
// GET /api/analytics/summary
// Returns summary.json contents or error state
router.get('/summary', async (req, res) => {
  const summaryPath = '/config/frame_art/logs/summary.json';
  try {
    const data = await fs.readFile(summaryPath, 'utf8');
    res.json({ success: true, data: JSON.parse(data) });
  } catch (error) {
    if (error.code === 'ENOENT') {
      res.json({ success: false, reason: 'no_data' });
    } else {
      res.status(500).json({ success: false, reason: 'error', error: error.message });
    }
  }
});
```

### Backend Route: `/api/analytics/events`
```javascript
// GET /api/analytics/events?image=filename.jpg&limit=10
// Returns recent events for a specific image (optional)
router.get('/events', async (req, res) => {
  const eventsPath = '/config/frame_art/logs/events.json';
  // ... filter and return events
});
```

### Frontend Data Flow
1. On tab switch to Analytics, fetch `/api/analytics/summary`
2. Parse and cache data in memory
3. Time range filter operates on cached data
4. Tag/Image selections update detail columns
5. Manual refresh button to re-fetch (no auto-polling)

### Chart Library
**Recommendation:** Use a lightweight library or pure CSS/SVG
- **Option A:** Chart.js (if already bundled) - full-featured but larger
- **Option B:** Pure CSS pie charts with conic-gradient - no dependencies
- **Option C:** Inline SVG generation - flexible, lightweight

For v1, CSS conic-gradient pie charts are recommended for simplicity:
```css
.pie-chart {
  width: 120px;
  height: 120px;
  border-radius: 50%;
  background: conic-gradient(
    #3498db 0% 42%,      /* nature */
    #e74c3c 42% 70%,     /* family */
    #2ecc71 70% 88%,     /* landscape */
    #95a5a6 88% 100%     /* <none> */
  );
}
```

---

## Empty/Error States

### No Data Yet
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                     â”‚
â”‚                         ğŸ“Š                                          â”‚
â”‚                                                                     â”‚
â”‚              No activity data yet                                   â”‚
â”‚                                                                     â”‚
â”‚   Activity logging tracks how long images are displayed on your     â”‚
â”‚   TVs. Data will appear here after the Frame Art Shuffler           â”‚
â”‚   integration starts recording sessions.                            â”‚
â”‚                                                                     â”‚
â”‚   Make sure logging is enabled in the integration settings.         â”‚
â”‚                                                                     â”‚
â”‚   [Open Integration Settings]                                       â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Logging Disabled
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                     â”‚
â”‚                         âš ï¸                                          â”‚
â”‚                                                                     â”‚
â”‚              Activity logging is disabled                           â”‚
â”‚                                                                     â”‚
â”‚   Enable logging in the Frame Art Shuffler integration settings     â”‚
â”‚   to start tracking display statistics.                             â”‚
â”‚                                                                     â”‚
â”‚   [Enable Logging]                                                  â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Error Loading
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                     â”‚
â”‚                         âŒ                                          â”‚
â”‚                                                                     â”‚
â”‚              Failed to load activity data                           â”‚
â”‚                                                                     â”‚
â”‚   Error: [error message]                                            â”‚
â”‚                                                                     â”‚
â”‚   [Retry]                                                           â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Implementation Phases

### Phase 1: Basic Analytics (MVP) âœ… COMPLETE
- [x] Backend route for summary.json
- [x] Backend merges display_periods from events.json
- [x] Analytics sub-tab with summary stats
- [x] Overall pie chart (time by image)
- [x] TV cards with pie charts (tag breakdown)
- [x] Tag dropdown with TV breakdown + top images
- [x] Image dropdown with thumbnail, tags, TV breakdown
- [x] Timeline bar for image display history per TV
- [x] Empty/error states
- [x] Test data (summary.json + events.json)

### Phase 2: Time Range Filtering â³ NOT STARTED
- [ ] Time range selector (1h, 24h, 7d, 30d, 6mo, All)
- [ ] Filter summary data by time range
- [ ] Filter events.json for timeline by time range
- [ ] Persist selection in localStorage
- [ ] Update all columns when range changes

### Phase 3: Visual Enhancements
- [ ] Image thumbnails in pie chart legend
- [ ] Click pie segment to filter
- [ ] Responsive layout for tablet/mobile

### Phase 4: Advanced Features
- [ ] Export data feature (CSV/JSON)
- [ ] Historical comparison (week-over-week)
- [ ] Integration with gallery (navigate to images)

---

## Design Tokens

### Colors
- **Primary:** `#3498db` (existing blue)
- **Success:** `#27ae60` (existing green)  
- **Warning:** `#f39c12` (existing orange)
- **Danger:** `#e74c3c` (existing red)
- **Neutral:** `#95a5a6` (existing gray)

### Chart Colors (Tag Palette)
```css
:root {
  --chart-color-1: #3498db;  /* Blue */
  --chart-color-2: #e74c3c;  /* Red */
  --chart-color-3: #2ecc71;  /* Green */
  --chart-color-4: #9b59b6;  /* Purple */
  --chart-color-5: #f39c12;  /* Orange */
  --chart-color-6: #1abc9c;  /* Teal */
  --chart-color-7: #e67e22;  /* Dark Orange */
  --chart-color-8: #95a5a6;  /* Gray - used for <none> or "other" */
}
```

---

## Questions to Resolve

1. ~~**Events access:** Should the add-on have read access to `events.json` for recent session history?~~ âœ… Yes - implemented for timeline feature

2. **Data export:** Should users be able to export analytics data as CSV/JSON?

3. **Gallery integration:** How deep should the linking be? Just navigate to image, or full modal view?

4. ~~**Chart library:** Stick with pure CSS, or add a library like Chart.js?~~ âœ… Pure CSS conic-gradient

5. **Time range filtering:** Should filtering happen client-side (on cached data) or server-side (re-fetch filtered data)?

---

## Files Modified/Created

### New Files
- `routes/analytics.js` - Backend API for summary + events
- `test-data/logs/summary.json` - Mock summary data for development
- `test-data/logs/events.json` - Mock event data for development/timeline

### Modified Files
- `server.js` - Mount analytics router
- `public/index.html` - Analytics sub-tab HTML structure
- `public/css/style.css` - Analytics styles (~500 lines)
- `public/js/app.js` - Analytics JavaScript functions

---

*Design created: December 2025*
*MVP implemented: December 2025*
