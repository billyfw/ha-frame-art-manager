<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ANCWBFW Frame Art Manager</title>
  <link rel="stylesheet" href="/css/style.css">
</head>
<body>
  <div class="container">
    <!-- Gallery Tab -->
    <div id="gallery-tab" class="tab-content active">
      <div class="gallery-toolbar">
        <button type="button" id="open-upload-btn" class="btn-primary btn-add">Add</button>
        <div class="controls">
          <div class="control-item control-search">
            <span class="control-icon">üîç</span>
            <input type="text" id="search-input" placeholder="Search images..." />
          </div>
        <div class="control-item control-filter">
          <button type="button" id="clear-tag-filter-btn" class="clear-filter-btn" style="display: none;" title="Clear filter">‚úï</button>
          <div class="custom-multiselect">
            <button type="button" id="tag-filter-btn" class="multiselect-button">
              <span id="tag-filter-text">All Tags</span>
              <span class="dropdown-arrow">‚ñº</span>
            </button>
            <div id="tag-filter-dropdown" class="multiselect-dropdown">
              <div id="tv-shortcuts" class="tv-shortcuts">
                <!-- TV shortcut checkboxes will be populated here -->
              </div>
              <div class="tags-header">TAGS</div>
              <div class="multiselect-options">
                <!-- Tag checkboxes will be populated here -->
              </div>
            </div>
          </div>
        </div>
        <div class="control-item control-sort">
          <button type="button" id="sort-direction-btn" class="sort-direction-btn" title="Toggle sort direction">
            <span id="sort-direction-icon">‚¨Ü</span>
          </button>
          <select id="sort-order">
            <option value="name">Name</option>
            <option value="date">Date Added</option>
          </select>
        </div>
        <div class="control-item control-settings">
          <button type="button" id="open-advanced-btn" class="btn-icon btn-settings" title="Advanced settings">‚öô</button>
        </div>
      </div>
        <button type="button" id="sync-btn" class="btn-icon btn-sync" title="Sync with cloud">
          <span id="sync-icon">‚òÅÔ∏è</span>
          <span id="sync-text">Synced</span>
          <span id="sync-badge" class="sync-badge" style="display: none;">0</span>
        </button>
      </div>

      <div id="bulk-actions" class="bulk-actions">
        <div class="bulk-actions-buttons">
          <button id="bulk-delete-btn" class="btn-danger">Delete Selected</button>
        </div>
        <div class="bulk-actions-buttons">
          <button id="bulk-tag-btn" class="btn-primary">Tag Selected</button>
          <button id="clear-selection-btn" class="btn-secondary">Clear Selection (<span id="selected-count">0</span>)</button>
        </div>
      </div>

      <div id="image-grid" class="image-grid">
        <!-- Images will be loaded here -->
      </div>
    </div>

    <!-- Upload Tab -->
    <div id="upload-tab" class="tab-content">
      <div class="upload-section">
        <div style="display:flex; align-items:center; justify-content:space-between; gap:10px;">
          <h2 style="margin:0;">Upload New Image</h2>
          <button id="go-home-upload-btn" class="btn-icon close-simple" title="Back to Gallery">‚úï</button>
        </div>
        <form id="upload-form" enctype="multipart/form-data">
          <div class="form-group">
            <label for="image-file">Select Image:</label>
            <input type="file" id="image-file" name="image" accept="image/*" capture="environment" required />
          </div>

          <div class="form-group">
            <label for="image-name">Image Name (optional):</label>
            <input type="text" id="image-name" name="customName" placeholder="e.g. BillyAmandaWeddingTrees" />
            <small class="form-hint">Leave blank to use original filename. UUID will be added to prevent duplicates. Name will be made lower case and special characters will become dashes.</small>
          </div>

          <div class="form-group">
            <label for="matte-select">Matte:</label>
            <select id="matte-select" name="matte">
              <option value="none">None</option>
              <option value="square_white">Square White</option>
              <option value="square_black">Square Black</option>
              <option value="square_beige">Square Beige</option>
              <option value="modern_white">Modern White</option>
              <option value="modern_black">Modern Black</option>
              <option value="modern_beige">Modern Beige</option>
            </select>
          </div>

          <div class="form-group">
            <label for="filter-select">Filter:</label>
            <select id="filter-select" name="filter">
              <option value="none">None</option>
              <option value="sepia">Sepia</option>
              <option value="grayscale">Grayscale</option>
              <option value="warm">Warm</option>
              <option value="cool">Cool</option>
            </select>
          </div>

          <div class="form-group">
            <label for="tags-input">Tags (comma-separated):</label>
            <input type="text" id="tags-input" name="tags" placeholder="nature, landscape, sunset" />
          </div>

          <button type="submit" class="btn-primary">Upload Image</button>
        </form>

        <div id="upload-status"></div>
      </div>
    </div>

    <!-- Advanced Tab -->
    <div id="advanced-tab" class="tab-content">
      <div class="section">
        <div style="display:flex; align-items:center; justify-content:space-between; gap:10px;">
          <h2 style="margin:0;">Advanced Settings</h2>
          <button id="go-home-btn" class="btn-icon close-simple" title="Back to Gallery">‚úï</button>
        </div>
        
        <!-- Sub-tabs for Advanced section -->
        <div class="advanced-tabs">
          <button class="advanced-tab-btn active" data-tab="settings">Settings</button>
          <button class="advanced-tab-btn" data-tab="metadata">Metadata</button>
        </div>

        <!-- Settings Sub-tab -->
        <div id="advanced-settings-content" class="advanced-tab-content active">
          <div class="subsection">
            <h3>Library Path</h3>
            <div class="info-box">
              <span class="path-label">üìÅ Current Path:</span>
              <code id="advanced-path-value" class="path-code">Loading...</code>
            </div>
          </div>

          <div class="subsection">
            <h3>Manage Tags</h3>
            <form id="tag-form" class="inline-form">
              <input type="text" id="tag-name" placeholder="New Tag" required />
              <button type="submit" class="btn-primary">Add Tag</button>
            </form>

            <div id="tag-list" class="tag-cloud">
              <!-- Tag list will be loaded here -->
            </div>
          </div>

          <div class="subsection">
            <h3>Manage TVs</h3>
            <form id="tv-form" class="inline-form">
              <input type="text" id="tv-name" placeholder="TV Name" required />
              <input type="text" id="tv-ip" placeholder="IP Address (e.g., 192.168.1.100)" required />
              <select id="tv-home" title="Home">
                <option value="Madrone">Madrone</option>
                <option value="Maui">Maui</option>
              </select>
              <button type="submit" class="btn-primary">Add TV</button>
            </form>

            <div id="tv-list" class="list">
              <!-- TV list will be loaded here -->
            </div>
          </div>
        </div>

        <!-- Metadata Sub-tab -->
        <div id="advanced-metadata-content" class="advanced-tab-content">
          <div class="subsection">
            <h3>Metadata Backend</h3>
            <p>View the raw metadata.json file for debugging</p>
            <button id="refresh-metadata-btn" class="btn-primary">Refresh Metadata</button>
            
            <div class="metadata-viewer">
              <pre id="metadata-content" class="code-block">Loading metadata...</pre>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Image Detail Modal -->
  <div id="image-modal" class="modal">
    <div class="modal-content">
      <button class="close close-simple" id="image-modal-close">‚úï</button>
      <div class="modal-image-container">
        <button class="expand-image-btn" id="expand-image-btn" title="View full size">‚§¢</button>
        <img id="modal-image" src="" alt="" />
      </div>
      <div class="modal-details">
        <div class="modal-header-section">
          <div class="modal-info-left">
            <div class="modal-filename-container">
              <h3 id="modal-filename"></h3>
              <button id="edit-filename-btn" class="btn-icon" title="Edit name">‚úèÔ∏è</button>
            </div>
            <div id="edit-filename-form" class="edit-filename-form" style="display: none;">
              <input type="text" id="edit-filename-input" placeholder="Enter new name" />
              <button id="save-filename-btn" class="btn-primary btn-small">Save</button>
              <button id="cancel-filename-btn" class="btn-secondary btn-small">Cancel</button>
            </div>
            <p class="modal-actual-filename">
              <small>File: <code id="modal-actual-filename"></code></small>
            </p>
            <p class="modal-dimensions">
              <small>Resolution: <strong id="modal-resolution"></strong> <span id="modal-aspect-badge"></span></small>
            </p>
            <div class="form-group form-group-compact">
              <label>Matte:</label>
              <select id="modal-matte">
                <option value="none">None</option>
                <option value="square_white">Square White</option>
                <option value="square_black">Square Black</option>
                <option value="square_beige">Square Beige</option>
                <option value="modern_white">Modern White</option>
                <option value="modern_black">Modern Black</option>
                <option value="modern_beige">Modern Beige</option>
              </select>
            </div>
            <div class="form-group form-group-compact">
              <label>Filter:</label>
              <select id="modal-filter">
                <option value="none">None</option>
                <option value="sepia">Sepia</option>
                <option value="grayscale">Grayscale</option>
                <option value="warm">Warm</option>
                <option value="cool">Cool</option>
              </select>
            </div>
          </div>
          <div class="modal-info-center">
            <div class="image-tag-section">
              <div class="form-group form-group-compact">
                <label>Add tags:</label>
                <div class="inline-input-group">
                  <input type="text" id="modal-tags-input" placeholder="tag1, tag2, tag3" />
                  <button id="modal-add-tags-btn" class="btn-primary">Add Tags</button>
                </div>
              </div>
            </div>
            <div class="image-tag-section image-tag-section-fill">
              <div class="image-tag-section-header">
                <strong>Tags</strong>
              </div>
              <div id="modal-tags-badges" class="tag-cloud">
                <!-- Populated by JavaScript -->
              </div>
            </div>
          </div>
        </div>
        <div class="modal-actions">
          <button id="modal-delete-btn" class="btn-danger">Delete Image</button>
          <div class="modal-actions-right">
            <button id="modal-cancel-btn" class="btn-done">Done</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Bulk Tag Modal -->
  <div id="bulk-tag-modal" class="modal">
    <div class="modal-content bulk-modal">
      <button class="close close-simple" id="bulk-modal-close">‚úï</button>
      <div class="modal-details">
        <h3>Manage Tags for <span id="bulk-count">0</span> Images</h3>
        
        <!-- Tags on ALL selected images -->
        <div class="bulk-tag-section">
          <div class="bulk-tag-section-header">
            <strong>On all images</strong>
          </div>
          <div id="bulk-all-tags" class="tag-cloud">
            <!-- Populated by JavaScript -->
          </div>
        </div>
        
        <!-- Tags on SOME selected images -->
        <div class="bulk-tag-section">
          <div class="bulk-tag-section-header">
            <strong>On some images</strong>
          </div>
          <div id="bulk-some-tags" class="tag-cloud">
            <!-- Populated by JavaScript -->
          </div>
        </div>
        
        <!-- Add new tags -->
        <div class="bulk-tag-section">
          <div class="form-group">
            <label>Add tags:</label>
            <div class="inline-input-group">
              <input type="text" id="bulk-tags-input" placeholder="tag1, tag2, tag3" />
              <button id="add-bulk-tags-btn" class="btn-primary">Add Tags</button>
            </div>
          </div>
          <div class="bulk-modal-actions">
            <button id="cancel-bulk-tags-btn" class="btn-done">Done</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- TV Detail Modal -->
  <div id="tv-modal" class="modal">
    <div class="modal-content tv-modal">
      <button class="close close-simple" id="tv-modal-close">‚úï</button>
      <div class="modal-details">
        <h3>TV Details</h3>
        <div class="form-group">
          <label>TV Name:</label>
          <input type="text" id="tv-modal-name" placeholder="TV Name" />
        </div>
        <div class="form-group">
          <label>IP Address:</label>
          <input type="text" id="tv-modal-ip" placeholder="192.168.1.100" />
        </div>
        <div class="form-group">
          <label>Home:</label>
          <div class="toggle-group" role="group" aria-label="Home">
            <button type="button" id="tv-home-madrone" class="toggle-btn" data-value="Madrone">Madrone</button>
            <button type="button" id="tv-home-maui" class="toggle-btn" data-value="Maui">Maui</button>
          </div>
        </div>
        <div class="form-group">
          <label>Display Tags:</label>
          <div id="tv-modal-tag-pills" class="tag-pills-container">
            <!-- Tag pills will be populated here -->
          </div>
          <button type="button" id="tv-modal-add-tag-btn" class="btn-secondary btn-sm">+ Add Tag</button>
        </div>
        <div class="modal-info">
          <p><small>Added: <span id="tv-modal-date"></span></small></p>
        </div>
        <div class="tv-modal-actions">
          <button id="tv-modal-delete-btn" class="btn-danger">Delete TV</button>
          <div class="tv-modal-actions-right">
            <button id="tv-modal-cancel-btn" class="btn-secondary">Cancel</button>
            <button id="tv-modal-save-btn" class="btn-primary">Save Changes</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- TV Tag Picker Modal -->
  <div id="tv-tag-picker-modal" class="modal">
    <div class="modal-content tv-tag-picker-modal">
      <span class="close" id="tv-tag-picker-close">&times;</span>
      <div class="modal-details">
        <h3>Select Tags for TV</h3>
        <div class="tag-picker-search">
          <input type="text" id="tv-tag-picker-search" placeholder="Search tags..." />
        </div>
        <div id="tv-tag-picker-list" class="tag-picker-list">
          <!-- Tag checkboxes will be populated here -->
        </div>
        <div class="modal-actions">
          <button id="tv-tag-picker-done-btn" class="btn-primary">Done</button>
          <button id="tv-tag-picker-cancel-btn" class="btn-secondary">Cancel</button>
        </div>
      </div>
    </div>
  </div>

  <script src="/js/app.js"></script>
</body>
</html>

