<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ANCWBFW Frame Art Manager</title>
  <base href="./">
  <link rel="stylesheet" href="css/style.css">
</head>
<body>
  <div class="container">
    <!-- Gallery Tab -->
    <div id="gallery-tab" class="tab-content active">
      <div class="gallery-toolbar">
        <button type="button" id="open-upload-btn" class="btn-primary btn-add">Add Image</button>
        
        <div class="toolbar-right">
          <div class="controls" role="toolbar" aria-label="Gallery controls">
            <div class="control-item control-search">
              <input type="search" id="search-input" placeholder="Search images" aria-label="Search images" autocomplete="off" />
            </div>
            <div class="control-item control-filter">
              <button type="button" id="clear-tag-filter-btn" class="clear-filter-btn-toolbar" title="Clear tag filter">√ó</button>
              <div class="custom-multiselect">
                <button type="button" id="tag-filter-btn" class="multiselect-button" aria-haspopup="listbox" aria-expanded="false">
                  <span id="tag-filter-text">All Tags</span>
                  <span class="dropdown-arrow">‚ñæ</span>
                </button>
                <div id="tag-filter-dropdown" class="multiselect-dropdown" role="menu">
                  <div class="multiselect-options">
                    <!-- Tag options injected here -->
                  </div>
                </div>
              </div>
            </div>
            <div class="control-item control-sort">
              <span class="sort-label" id="sort-label">Sort</span>
              <select id="sort-order" aria-labelledby="sort-label">
                <option value="date">Add date</option>
                <option value="name">Filename</option>
              </select>
              <button type="button" id="sort-direction-btn" class="sort-direction-btn" title="Toggle sort direction" aria-label="Toggle sort direction">‚Üì</button>
            </div>
          </div>

          <div class="toolbar-row toolbar-row-1">
            <button type="button" id="open-batch-upload-btn" class="btn-toolbar" title="Bulk upload new images with default metadata (max 20MB per image)">Batch Add</button>
            <div class="control-item control-settings">
              <button type="button" id="open-analytics-btn" class="btn-toolbar" title="Analytics & Log">Stats</button>
              <button type="button" id="open-advanced-btn" class="btn-toolbar" title="Advanced settings">Advanced</button>
            </div>
            <div class="control-item control-sync">
              <button type="button" id="sync-btn" class="btn-icon btn-sync" title="Sync with cloud">
                <span id="sync-icon">‚úÖ</span>
                <span id="sync-text">Synced</span>
                <span id="sync-badge" class="sync-badge" style="display: none;">0</span>
              </button>
            </div>
          </div>
        </div>
      </div>

      <div id="bulk-actions" class="bulk-actions">
        <div class="bulk-actions-buttons">
          <button id="bulk-delete-btn" class="btn-danger"><span class="desktop-text">Delete Selected</span><span class="mobile-text">Delete</span></button>
        </div>
        <div class="bulk-actions-buttons">
          <button id="bulk-tag-btn" class="btn-primary"><span class="desktop-text">Tag Selected</span><span class="mobile-text">Tag</span></button>
          <button id="select-all-btn" class="btn-secondary"><span class="desktop-text">Select All</span><span class="mobile-text">Select<br>All</span></button>
          <button id="clear-selection-btn" class="btn-secondary"><span class="desktop-text">Clear Selection (<span id="selected-count">0</span>)</span><span class="mobile-text">Deselect<br>(<span id="selected-count-mobile">0</span>)</span></button>
        </div>
      </div>

      <div id="image-grid" class="image-grid">
        <!-- Images will be loaded here -->
      </div>
    </div>

    <!-- Upload Tab -->
    <div id="upload-tab" class="tab-content">
      <div class="upload-section">
        <div style="display:flex; align-items:center; justify-content:space-between; gap:10px;">
          <h2 style="margin:0;">Upload New Image</h2>
          <button id="go-home-upload-btn" class="btn-icon close-simple" title="Back to Gallery">‚úï</button>
        </div>
        <form id="upload-form" enctype="multipart/form-data">
          <div class="form-group">
            <label for="image-file">Select Image:</label>
            <div class="file-input-wrapper">
              <input type="file" id="image-file" name="image" accept="image/*" required />
              <button type="button" id="clear-file-btn" class="btn-clear-file hidden" title="Clear selected file">‚úï</button>
            </div>
          </div>

          <div class="upload-preview hidden" id="upload-preview-container">
            <div id="upload-preview-spinner" class="upload-preview-spinner hidden" aria-hidden="true"></div>
            <img id="upload-preview-image" alt="Upload preview" class="hidden" />
            <div id="upload-preview-error" class="upload-preview-error hidden" role="status" aria-live="polite"></div>
          </div>

          <div class="form-group">
            <label for="image-name">Image Name (optional):</label>
            <input type="text" id="image-name" name="customName" placeholder="e.g. BillyAmandaWeddingTrees" />
            <small class="form-hint">Leave blank to use original filename. UUID will be added to prevent duplicates. Name will be made lower case and special characters will become dashes.</small>
          </div>

          <div class="form-group">
            <label for="matte-select">Matte:</label>
            <select id="matte-select" name="matte">
              <option value="none">none</option>
              <option value="modernthin">modernthin</option>
              <option value="modern">modern</option>
              <option value="modernwide">modernwide</option>
              <option value="flexible">flexible</option>
              <option value="shadowbox">shadowbox</option>
              <option value="panoramic">panoramic</option>
              <option value="triptych">triptych</option>
              <option value="mix">mix</option>
              <option value="squares">squares</option>
            </select>
          </div>

          <div class="form-group">
            <label for="filter-select">Filter:</label>
            <select id="filter-select" name="filter">
              <option value="None">None</option>
              <option value="Aqua">Aqua</option>
              <option value="ArtDeco">Art Deco</option>
              <option value="Ink">Ink</option>
              <option value="Wash">Wash</option>
              <option value="Pastel">Pastel</option>
              <option value="Feuve">Feuve</option>
            </select>
          </div>

          <div class="form-group">
            <label for="tags-input">Tags (comma-separated):</label>
            <input type="text" id="tags-input" name="tags" placeholder="nature, landscape, sunset" />
          </div>

          <button type="submit" class="btn-primary">Upload Image</button>
        </form>

        <div id="upload-status"></div>
      </div>
    </div>

    <!-- Advanced Tab -->
    <div id="advanced-tab" class="tab-content">
      <div class="section">
        <div style="display:flex; align-items:center; justify-content:space-between; gap:10px;">
          <h2 style="margin:0;">Advanced Settings</h2>
          <button id="go-home-btn" class="btn-icon close-simple" title="Back to Gallery">‚úï</button>
        </div>
        
        <!-- Sub-tabs for Advanced section -->
        <div class="advanced-tabs">
          <button class="advanced-tab-btn active" data-tab="settings">Settings</button>
          <button class="advanced-tab-btn" data-tab="metadata">Metadata</button>
          <button class="advanced-tab-btn" data-tab="sync">Sync Detail</button>
        </div>

        <!-- Settings Sub-tab -->
        <div id="advanced-settings-content" class="advanced-tab-content active">
          <div class="subsection">
            <h3>Library Path</h3>
            <div class="info-box">
              <span class="path-label">üìÅ Current Path:</span>
              <code id="advanced-path-value" class="path-code">Loading...</code>
            </div>
          </div>

          <div class="subsection">
            <h3>Manage Tags</h3>
            <form id="tag-form" class="inline-form">
              <input type="text" id="tag-name" placeholder="New Tag" required />
              <button type="submit" class="btn-primary">Add Tag</button>
            </form>

            <div id="tag-list" class="tag-cloud">
              <!-- Tag list will be loaded here -->
            </div>
          </div>
        </div>

        <!-- Metadata Sub-tab -->
        <div id="advanced-metadata-content" class="advanced-tab-content">
          <div class="subsection">
            <h3>Metadata Backend</h3>
            <p>View the raw metadata.json file for debugging</p>
            <button id="refresh-metadata-btn" class="btn-primary">Refresh Metadata</button>
            
            <div class="metadata-viewer">
              <pre id="metadata-content" class="code-block">Loading metadata...</pre>
            </div>
          </div>
        </div>

        <!-- Sync Detail Sub-tab -->
        <div id="advanced-sync-content" class="advanced-tab-content">
          <!-- Git Status Section -->
          <div class="subsection">
            <h3>Git Status</h3>
            
            <div id="git-status-container" class="info-box" style="margin-bottom:20px;">
              <div class="loading-indicator">Loading git status...</div>
            </div>
          </div>

          <div class="subsection">
            <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 12px;">
              <h3 style="margin: 0;">Sync History (last 200)</h3>
              <label style="display: flex; align-items: center; gap: 6px; font-size: 14px; cursor: pointer;">
                <input type="checkbox" id="show-problems-only" checked>
                <span>Show problems only</span>
              </label>
            </div>
            <div id="sync-log-container" class="sync-log-container">
              <div class="loading-indicator">Loading sync history...</div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Analytics Tab -->
    <div id="analytics-tab" class="tab-content">
      <div class="section">
        <div class="analytics-header">
          <h2 style="margin:0;">Analytics & Log</h2>
          <button id="go-home-analytics-btn" class="btn-icon close-simple" title="Back to Gallery">‚úï</button>
        </div>
        
        <div class="analytics-page-content">
          <!-- Title row with subtitle left, pills right -->
          <div class="analytics-chart-header">
            <div class="date-range-hint" id="analytics-date-range"></div>
            <div class="time-range-pills" id="analytics-time-range-buttons">
              <button class="time-pill" data-range="1h">1 hour</button>
              <button class="time-pill" data-range="12h">12 hours</button>
              <button class="time-pill" data-range="1d">1 day</button>
              <button class="time-pill active" data-range="1w">1 week</button>
              <button class="time-pill" data-range="1mo">1 month</button>
              <button class="time-pill" data-range="6mo">6 months</button>
            </div>
          </div>

          <!-- Mobile tabs for columns (hidden on desktop) - right below pills -->
          <div class="analytics-mobile-tabs">
            <button class="analytics-mobile-tab active" data-column="time">Time</button>
            <button class="analytics-mobile-tab" data-column="tvs">TVs</button>
            <button class="analytics-mobile-tab" data-column="tags">Tags</button>
            <button class="analytics-mobile-tab" data-column="images">Images</button>
          </div>

          <!-- Overall chart by image -->
          <div class="analytics-top-chart">
            <div class="top-chart-container">
              <div id="analytics-distribution-stats" class="distribution-stats"></div>
              <div id="analytics-image-pie" class="image-pie-chart-area">
                <div class="loading-indicator">Loading...</div>
              </div>
              <div id="analytics-bucket-detail" class="bucket-detail-container"></div>
            </div>
          </div>

          <!-- Three column layout -->
          <div class="analytics-columns">
            <!-- Column 1: TVs -->
            <div class="analytics-column analytics-tvs" data-column="tvs">
              <div class="column-header">
                <h4>TVs</h4>
                <select id="analytics-tv-select" class="analytics-select">
                  <option value="">Select a TV...</option>
                </select>
                <div id="analytics-tv-stats" class="column-stats"></div>
              </div>
              <div id="analytics-tv-detail" class="analytics-detail-panel">
                <div class="empty-state-small">Select a TV to view details</div>
              </div>
            </div>

            <!-- Column 2: Tags -->
            <div class="analytics-column analytics-tags" data-column="tags">
              <div class="column-header">
                <h4>Tags</h4>
                <select id="analytics-tag-select" class="analytics-select">
                  <option value="">Select a tag...</option>
                </select>
                <div id="analytics-tag-stats" class="column-stats"></div>
              </div>
              <div id="analytics-tag-detail" class="analytics-detail-panel">
                <div class="empty-state-small">Select a tag to view details</div>
              </div>
            </div>

            <!-- Column 3: Images -->
            <div class="analytics-column analytics-images" data-column="images">
              <div class="column-header">
                <div class="column-header-row">
                  <h4>Images</h4>
                  <div id="analytics-image-tags" class="column-header-tags"></div>
                </div>
                <select id="analytics-image-select" class="analytics-select">
                  <option value="">Select an image...</option>
                </select>
                <div id="analytics-image-stats" class="column-stats"></div>
              </div>
              <div id="analytics-image-detail" class="analytics-detail-panel">
                <div class="empty-state-small">Select an image to view details</div>
              </div>
            </div>
          </div>

          <!-- Empty/Error states (hidden by default) -->
          <div id="analytics-empty-state" class="analytics-empty-state" style="display: none;">
            <div class="empty-icon-text">No Data</div>
            <h3>No activity data yet</h3>
            <p>Activity logging tracks how long images are displayed on your TVs. Data will appear here after the Frame Art Shuffler integration starts recording sessions.</p>
            <p class="hint">Make sure logging is enabled in the integration settings.</p>
          </div>

          <div id="analytics-error-state" class="analytics-error-state" style="display: none;">
            <div class="empty-icon-text">Error</div>
            <h3>Failed to load activity data</h3>
            <p id="analytics-error-message">Unknown error</p>
            <button id="analytics-retry-btn" class="btn-primary">Retry</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div id="image-modal" class="modal">
      <div class="modal-content">
        <button class="close close-simple" id="image-modal-close">‚úï</button>
        
      <div class="modal-image-container mobile-section-preview mobile-section-edit">
        <button class="expand-image-btn" id="expand-image-btn" title="View full size">‚§¢</button>
        <div class="modal-image-stage" id="modal-image-stage">
          <img id="modal-image" src="" alt="" />
          <div id="crop-overlay" class="crop-overlay hidden">
            <div class="crop-box" id="crop-box">
              <div class="crop-handle handle-nw" data-handle="nw"></div>
              <div class="crop-handle handle-n" data-handle="n"></div>
              <div class="crop-handle handle-ne" data-handle="ne"></div>
              <div class="crop-handle handle-e" data-handle="e"></div>
              <div class="crop-handle handle-se" data-handle="se"></div>
              <div class="crop-handle handle-s" data-handle="s"></div>
              <div class="crop-handle handle-sw" data-handle="sw"></div>
              <div class="crop-handle handle-w" data-handle="w"></div>
            </div>
          </div>
        </div>
      </div>
      <div id="image-edit-toolbar" class="image-edit-toolbar mobile-section-edit">
        <div class="toolbar-group toolbar-group-primary">
          <button id="toolbar-edit-btn" class="toolbar-btn">Edit</button>
          <button id="revert-original-btn" class="toolbar-btn" disabled>Revert to Original Unedited</button>
        </div>
        <div class="toolbar-divider"></div>
        <div class="toolbar-group toolbar-group-tools">
          <button class="toolbar-icon-btn preview-toggle-btn" id="toolbar-preview-toggle-btn" title="Hide Preview" aria-pressed="false" disabled>
            <span class="sr-only">Toggle preview</span>
            <svg class="toolbar-icon-svg icon-eye-open" viewBox="0 0 24 24" aria-hidden="true">
              <path d="M2 12s3.6-7 10-7 10 7 10 7-3.6 7-10 7S2 12 2 12Z" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"></path>
              <circle cx="12" cy="12" r="3.2" fill="none" stroke="currentColor" stroke-width="1.8"></circle>
            </svg>
            <svg class="toolbar-icon-svg icon-eye-closed" viewBox="0 0 24 24" aria-hidden="true">
              <path d="M2 12s3.6-7 10-7 10 7 10 7-3.6 7-10 7S2 12 2 12Z" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"></path>
              <line x1="4" y1="4" x2="20" y2="20" stroke="currentColor" stroke-width="1.8" stroke-linecap="round"></line>
            </svg>
          </button>
          <span class="toolbar-divider toolbar-divider-inline" aria-hidden="true"></span>
          <button class="toolbar-icon-btn" data-tool="crop" title="Crop" disabled>
            <svg class="toolbar-icon-svg" viewBox="0 0 24 24" aria-hidden="true">
              <path d="M7 4v13a2 2 0 0 0 2 2h13" fill="none" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"></path>
              <path d="M4 7h13a2 2 0 0 1 2 2v13" fill="none" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"></path>
              <line x1="4" y1="4" x2="9" y2="4" stroke="currentColor" stroke-width="1.6" stroke-linecap="round"></line>
              <line x1="4" y1="4" x2="4" y2="9" stroke="currentColor" stroke-width="1.6" stroke-linecap="round"></line>
            </svg>
          </button>
          <button class="toolbar-icon-btn" data-tool="adjust" title="Brightness / Contrast" disabled>
            <svg class="toolbar-icon-svg" viewBox="0 0 24 24" aria-hidden="true">
              <line x1="5" y1="7" x2="19" y2="7" stroke="currentColor" stroke-width="1.6" stroke-linecap="round"></line>
              <line x1="5" y1="12" x2="19" y2="12" stroke="currentColor" stroke-width="1.6" stroke-linecap="round"></line>
              <line x1="5" y1="17" x2="19" y2="17" stroke="currentColor" stroke-width="1.6" stroke-linecap="round"></line>
              <circle cx="10" cy="7" r="2.2" fill="none" stroke="currentColor" stroke-width="1.6"></circle>
              <circle cx="15" cy="12" r="2.2" fill="none" stroke="currentColor" stroke-width="1.6"></circle>
              <circle cx="12" cy="17" r="2.2" fill="none" stroke="currentColor" stroke-width="1.6"></circle>
            </svg>
          </button>
          <button class="toolbar-icon-btn" data-tool="filter" title="Filters" disabled>
            <svg class="toolbar-icon-svg" viewBox="0 0 24 24" aria-hidden="true">
              <path d="M4 5h16l-5.8 7.2v5.7l-4.4 3.6V12.2Z" fill="none" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"></path>
              <line x1="4" y1="5" x2="20" y2="5" stroke="currentColor" stroke-width="1.6" stroke-linecap="round"></line>
              <line x1="10" y1="21.5" x2="10" y2="16.5" stroke="currentColor" stroke-width="1.6" stroke-linecap="round"></line>
            </svg>
          </button>
        </div>
        <div class="toolbar-flex"></div>
        <div class="toolbar-group toolbar-group-secondary">
          <button id="modal-show-tv-btn" class="toolbar-btn" style="margin-right: 8px;">Show on TV</button>
          <button id="toolbar-cancel-btn" class="toolbar-btn" disabled>Cancel</button>
          <button id="toolbar-apply-btn" class="btn-primary toolbar-apply" disabled>Apply</button>
        </div>
      </div>
      <div id="edit-popover-container" class="edit-popover-container mobile-section-edit">
        <div id="adjustments-popover" class="edit-popover hidden">
          <div class="popover-header">Brightness &amp; Contrast</div>
          <label class="popover-slider">
            <span>Brightness</span>
            <input type="range" id="adjust-brightness" min="-100" max="100" value="0" step="1">
            <span class="slider-value" id="adjust-brightness-value">0</span>
          </label>
          <label class="popover-slider">
            <span>Contrast</span>
            <input type="range" id="adjust-contrast" min="-100" max="100" value="0" step="1">
            <span class="slider-value" id="adjust-contrast-value">0</span>
          </label>
          <div class="popover-header popover-header-secondary">Hue, Saturation &amp; Lightness</div>
          <label class="popover-slider">
            <span>Hue</span>
            <input type="range" id="adjust-hue" min="-180" max="180" value="0" step="1">
            <span class="slider-value" id="adjust-hue-value">0¬∞</span>
          </label>
          <label class="popover-slider">
            <span>Saturation</span>
            <input type="range" id="adjust-saturation" min="-100" max="100" value="0" step="1">
            <span class="slider-value" id="adjust-saturation-value">0</span>
          </label>
          <label class="popover-slider">
            <span>Lightness</span>
            <input type="range" id="adjust-lightness" min="-100" max="100" value="0" step="1">
            <span class="slider-value" id="adjust-lightness-value">0</span>
          </label>
        </div>
        <div id="filters-popover" class="edit-popover hidden">
          <div class="popover-header">Filters</div>
          <div class="filter-chip-row" id="filter-chip-row">
            <button class="filter-chip active" data-filter="none">None</button>
            <button class="filter-chip" data-filter="sketch">Sketch / Charcoal</button>
            <button class="filter-chip" data-filter="oil-paint">Oil Painting</button>
            <button class="filter-chip" data-filter="watercolor">Watercolor</button>
            <button class="filter-chip" data-filter="impressionist">Impressionist</button>
            <button class="filter-chip" data-filter="pop-art">Pop Art</button>
            <button class="filter-chip" data-filter="art-deco">Art Deco Stylization</button>
            <button class="filter-chip" data-filter="neural-style">Neural Style</button>
            <button class="filter-chip" data-filter="noir-cinema">Noir Cinema</button>
            <button class="filter-chip" data-filter="silver-pearl">Silver Pearl</button>
            <button class="filter-chip" data-filter="graphite-ink">Graphite Ink</button>
          </div>
        </div>
        <div id="crop-popover" class="edit-popover hidden">
          <div class="popover-header">Crop Presets</div>
          <div class="crop-toolbar-row">
            <div class="crop-preset-row">
              <button class="crop-preset" data-crop="free">Free</button>
              <button class="crop-preset" data-crop="original">Original</button>
              <button class="crop-preset" data-crop="1:1">1:1</button>
              <button class="crop-preset" data-crop="4:3">4:3</button>
              <button class="crop-preset" data-crop="3:2">3:2</button>
              <button class="crop-preset" data-crop="16:9" title="Crop to 16:9 without resizing the image">16:9</button>
              <button class="crop-preset" data-crop="16:9sam" title="Crop and resize to 3840x2160 for Samsung Frame TVs">16:9SAM</button>
            </div>
            <div class="crop-warning" id="crop-upsampling-warning">Will upsample to 3840x2160 for 16:9SAM</div>
          </div>
        </div>
      </div>
      <div class="modal-body-scroll">
        <div class="modal-details">
        <div class="modal-header-section">
          <div class="modal-info-left mobile-section-preview">
            <button id="modal-stats-link" class="modal-stats-link" title="View Stats">üìä</button>
            <div class="modal-filename-container">
              <h3 id="modal-filename"></h3>
              <button id="edit-filename-btn" class="btn-icon" title="Edit name">‚úèÔ∏è</button>
            </div>
            <div id="edit-filename-form" class="edit-filename-form" style="display: none;">
              <input type="text" id="edit-filename-input" placeholder="Enter new name" />
              <button id="save-filename-btn" class="btn-primary btn-small">Save</button>
              <button id="cancel-filename-btn" class="btn-secondary btn-small">Cancel</button>
            </div>
            <p class="modal-actual-filename">
              <small>File: <code id="modal-actual-filename"></code></small>
              <small class="modal-file-size-inline"> (<span id="modal-file-size"></span>)</small>
            </p>
            <p class="modal-dimensions">
              <small>Resolution: <span id="modal-resolution"></span> <span id="modal-aspect-badge"></span></small>
            </p>
            <div class="form-group form-group-compact">
              <label>Matte:</label>
              <select id="modal-matte">
                <option value="none">none</option>
                <option value="modernthin">modernthin</option>
                <option value="modern">modern</option>
                <option value="modernwide">modernwide</option>
                <option value="flexible">flexible</option>
                <option value="shadowbox">shadowbox</option>
                <option value="panoramic">panoramic</option>
                <option value="triptych">triptych</option>
                <option value="mix">mix</option>
                <option value="squares">squares</option>
              </select>
            </div>
            <div class="form-group form-group-compact">
              <label>Filter:</label>
              <select id="modal-filter">
                <option value="None">None</option>
                <option value="Aqua">Aqua</option>
                <option value="ArtDeco">Art Deco</option>
                <option value="Ink">Ink</option>
                <option value="Wash">Wash</option>
                <option value="Pastel">Pastel</option>
                <option value="Feuve">Feuve</option>
              </select>
            </div>
            <div class="image-edit-entry">
              <button id="open-edit-panel-btn" class="btn-secondary">Edit Image</button>
            </div>
            <div class="mobile-show-tv-wrapper">
              <button id="mobile-show-tv-btn" class="btn-primary">Show on TV</button>
            </div>
          </div>
          <div class="modal-info-center mobile-section-tags">
            <div class="image-tag-section">
              <div class="form-group form-group-compact">
                <label>Add tags:</label>
                <div class="inline-input-group">
                  <input type="text" id="modal-tags-input" placeholder="tag1, tag2, tag3" />
                  <button id="modal-add-tags-btn" class="btn-primary">Add Tags</button>
                </div>
                <div class="tv-tags-wrapper" id="tv-tags-wrapper">
                  <span class="tv-tags-label">Suggested:</span>
                  <div class="tv-tags-helper" id="tv-tags-helper">
                    <!-- Populated by JavaScript -->
                  </div>
                </div>
              </div>
            </div>
            <div class="image-tag-section image-tag-section-fill">
              <div class="image-tag-section-header">
                <label>Applied tags:</label>
              </div>
              <div id="modal-tags-badges" class="tag-cloud">
                <!-- Populated by JavaScript -->
              </div>
            </div>
          </div>
        </div>
        <div id="modal-edit-panel" class="modal-edit-panel hidden">
          <div class="edit-preview-wrapper">
            <canvas id="edit-preview-canvas" width="640" height="360"></canvas>
          </div>
          <div class="edit-controls-grid">
            <div class="edit-control-group">
              <h4>Crop</h4>
              <div class="crop-slider">
                <label>Top <span id="crop-top-value" class="edit-value">0%</span></label>
                <input type="range" id="crop-top" min="0" max="40" step="1" value="0">
              </div>
              <div class="crop-slider">
                <label>Right <span id="crop-right-value" class="edit-value">0%</span></label>
                <input type="range" id="crop-right" min="0" max="40" step="1" value="0">
              </div>
              <div class="crop-slider">
                <label>Bottom <span id="crop-bottom-value" class="edit-value">0%</span></label>
                <input type="range" id="crop-bottom" min="0" max="40" step="1" value="0">
              </div>
              <div class="crop-slider">
                <label>Left <span id="crop-left-value" class="edit-value">0%</span></label>
                <input type="range" id="crop-left" min="0" max="40" step="1" value="0">
              </div>
            </div>
            <div class="edit-control-group">
              <h4>Adjustments</h4>
              <div class="adjustment-slider">
                <label>Brightness <span id="brightness-value" class="edit-value">0</span></label>
                <input type="range" id="brightness-slider" min="-100" max="100" step="1" value="0">
              </div>
              <div class="adjustment-slider">
                <label>Contrast <span id="contrast-value" class="edit-value">0</span></label>
                <input type="range" id="contrast-slider" min="-100" max="100" step="1" value="0">
              </div>
            </div>
            <div class="edit-control-group">
              <h4>Filter</h4>
              <div class="edit-filter-options" role="radiogroup">
                <button type="button" class="filter-chip active" data-filter="none">None</button>
                <button type="button" class="filter-chip" data-filter="sketch">Sketch / Charcoal</button>
                <button type="button" class="filter-chip" data-filter="oil-paint">Oil Painting</button>
                <button type="button" class="filter-chip" data-filter="watercolor">Watercolor</button>
                <button type="button" class="filter-chip" data-filter="impressionist">Impressionist</button>
                <button type="button" class="filter-chip" data-filter="pop-art">Pop Art</button>
                <button type="button" class="filter-chip" data-filter="art-deco">Art Deco Stylization</button>
                <button type="button" class="filter-chip" data-filter="neural-style">Neural Style</button>
                <button type="button" class="filter-chip" data-filter="noir-cinema">Noir Cinema</button>
                <button type="button" class="filter-chip" data-filter="silver-pearl">Silver Pearl</button>
                <button type="button" class="filter-chip" data-filter="graphite-ink">Graphite Ink</button>
              </div>
            </div>
          </div>
          <div id="edit-status-message" class="edit-status"></div>
          <div class="edit-actions">
            <div class="edit-actions-left">
              <button id="edit-reset-btn" class="btn-secondary">Reset</button>
            </div>
            <div class="edit-actions-right">
              <button id="edit-cancel-btn" class="btn-secondary">Cancel</button>
              <button id="edit-apply-btn" class="btn-primary">Apply Edits</button>
            </div>
          </div>
        </div>
        <div class="modal-actions">
            <div class="modal-actions-left">
              <button id="modal-delete-btn" class="btn-danger">Delete Image</button>
            </div>
            <div class="modal-actions-right">
              <button id="modal-cancel-btn" class="btn-done">Done</button>
            </div>
        </div>
      </div>
      </div>
    </div>
  </div>

  <!-- Bulk Tag Modal -->
  <div id="bulk-tag-modal" class="modal">
    <div class="modal-content bulk-modal">
      <button class="close close-simple" id="bulk-modal-close">‚úï</button>
      <div class="modal-details">
        <h3>Manage Tags for <span id="bulk-count">0</span> Images</h3>
        
        <!-- Tags on ALL selected images -->
        <div class="bulk-tag-section">
          <div class="bulk-tag-section-header">
            <strong>On all images</strong>
          </div>
          <div id="bulk-all-tags" class="tag-cloud">
            <!-- Populated by JavaScript -->
          </div>
        </div>
        
        <!-- Tags on SOME selected images -->
        <div class="bulk-tag-section">
          <div class="bulk-tag-section-header">
            <strong>On some images</strong>
          </div>
          <div id="bulk-some-tags" class="tag-cloud">
            <!-- Populated by JavaScript -->
          </div>
        </div>
        
        <!-- Add new tags -->
        <div class="bulk-tag-section">
          <div class="form-group">
            <label>Add tags:</label>
            <div class="inline-input-group">
              <input type="text" id="bulk-tags-input" placeholder="tag1, tag2, tag3" />
              <button id="add-bulk-tags-btn" class="btn-primary">Add Tags</button>
            </div>
          </div>
          <div class="bulk-modal-actions">
            <button id="cancel-bulk-tags-btn" class="btn-done">Done</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- TV Selection Modal -->
  <div id="tv-select-modal" class="modal">
    <div class="modal-content tv-modal">
      <button class="close close-simple" id="tv-modal-close">‚úï</button>
      <div class="modal-details">
        <h3>Show on TV</h3>
        <p>Select a Frame TV to display this image:</p>
        
        <div id="tv-list-container" class="tv-list">
          <div class="loading-indicator">Loading TVs...</div>
        </div>
        
        <div id="tv-upload-logs" class="tv-upload-logs" style="display: none; margin-top: 15px; padding: 10px; background: #f5f5f5; border-radius: 4px; font-family: monospace; font-size: 0.85em; max-height: 150px; overflow-y: auto; white-space: pre-wrap; border: 1px solid #ddd;"></div>
      </div>
    </div>
  </div>

  <script src="js/app.js"></script>
</body>
</html>

